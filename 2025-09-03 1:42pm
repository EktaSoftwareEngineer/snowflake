/SHOW PARAMETERS like 'network_policy' in account;


//SELECT CURRENT_REGION();

cnb98966.us-west-2.aws

alter account unset network_policy;


USE ROLE ACCOUNTADMIN;
USE WAREHOUSE COMPUTE_WH;
CREATE OR REPLACE DATABASE MYDBSNOW;
CREATE OR REPLACE SCHEMA MYSCHEMASNOW;
CREATE OR REPLACE TABLE PERMANENT_TABLE (
    
    ID INT, 
    NAME STRING
);
MYDBSNOW.MYSCHEMASNOW.CUSTOMER_STAGE
CREATE OR REPLACE TRANSIENT TABLE TRANSIENT_TABLE (   
    ID INT, 
    NAME STRING
);
CREATE OR REPLACE TEMPORARY TABLE TEMPORARY_TABLE (    
    ID INT, 
    NAME STRING
);

SHOW TABLES;

ALTER TABLE PERMANENT_TABLE SET DATA_RETENTION_TIME_IN_DAYS =5;

ALTER TABLE TRANSIENT_TABLE SET DATA_RETENTION_TIME_IN_DAYS =5;
// invalid value [5] for parameter 'DATA_RETENTION_TIME_IN_DAYS'

ALTER TABLE TEMPORARY_TABLE SET DATA_RETENTION_TIME_IN_DAYS =2;
//invalid value [2] for parameter 'DATA_RETENTION_TIME_IN_DAYS'

CREATE OR REPLACE TABLE Employee_DEA(
ID INTEGER, 
NAME VARCHAR(50),
DEPARTMENT VARCHAR(50),
SALARY INTEGER
);
INSERT INTO Employee_DEA(ID, NAME, DEPARTMENT,SALARY)VALUES
(1, 'Avirup', 'IT', 200000),
(2, 'Azmat', 'COMPUTER SCIENCE', 202000),
(3, 'Kareem', 'IT', 202000),
(4, 'JAY', 'COMPUTER SCIENCE', 200000);

INSERT INTO Employee_DEA(ID, NAME, DEPARTMENT,SALARY)VALUES
(5, 'Alex', 'HR', 200000),
(6, 'Elan', 'OPERATIONS', 202000),
(7, 'Milli', 'HR', 202000),
(8, 'Ajay', 'COMPUTER SCIENCE', 200000);
TRUNCATE Employee_DEA;
SELECT * FROM Employee_DEA;

CREATE OR REPLACE VIEW it_employee AS
SELECT ID, NAME, SALARY FROM EMPLOYEE_DEA WHERE DEPARTMENT ='IT';

SELECT * FROM it_employee;

CREATE OR REPLACE secure VIEW hr_employee AS
SELECT ID, NAME, SALARY FROM EMPLOYEE_DEA WHERE DEPARTMENT ='HR';

SELECT * FROM hr_employee;

CREATE OR REPLACE VIEW Sal_employee AS
SELECT DEPARTMENT, 
SUM(SALARY)AS total_Salary 
FROM EMPLOYEE_DEA 
GROUP BY DEPARTMENT;

SELECT * FROM SAL_EMPLOYEE;

CREATE OR REPLACE MATERIALIZED VIEW materialized_Sal_employee AS
SELECT DEPARTMENT, 
SUM(SALARY)AS total_Salary 
FROM EMPLOYEE_DEA 
GROUP BY DEPARTMENT;

SELECT * FROM materialized_Sal_employee;

CREATE OR REPLACE TABLE customer(
id INTEGER, 
name VARCHAR(50),
age INTEGER,
state VARCHAR(50)
);
list @%customer;
List @~ ;

CREATE OR REPLACE STAGE customer_stage;

List @%CUSTOMER;
list @CUSTOMER_STAGE;
SELECT * FROM CUSTOMER;

copy into CUSTOMER 
FROM @CUSTOMER_STAGE
file_format =(TYPE ='CSV'SKIP_header=1);
SELECT * FROM CUSTOMER;

CREATE OR REPLACE FILE FORMAT CSV_FORMAT
TYPE = 'CSV'
FIELD_DELIMITER =','
RECORD_DELIMITER ='\n'
SKIP_HEADER =1;

CREATE OR REPLACE FILE FORMAT JSON_FORMAT
TYPE ='JSON';

SHOW FILE FORMATS;






